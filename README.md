# aem-backup-cli
A Developer CLI utility to backup local AEM instances, and save lives!

> I have not tested this on windows, if you did, please let me know it works (on not).

<p align="center">
  <br>
  <img src="screenshot.svg">
  <br>
</p>

## Usage

```bash
$ npm install -g aem-backup-cli
```
`cd` into your AEM instance directory (where `crx-quickstart` folder is)

```bash
$ aemb
```
> **Your AEM instance must be completely SHUTDOWN before performing a backup**
> 
> If you break it, it's no my fault ;)

Voila! you are now in the interactive CLI. You can now enjoy all available commands, for example `help` prints:

```bash

aemb$ help

  Commands:

    help [command...]              Provides help for a given command.
    exit                           Exits application.
    backup [options] [backupName]  Archive crx-quickstart in current directory and move archive to crx-quickstart.backups folder in current directory
    list                           List all available backups
    delete [options]               Delete a backup from available backups
    restore [options]              Restore a backup from a list of available backups

```

### Examples
before anything:

1. `cd` into your AEM instance directory (where `crx-quickstart` folder is)
2. run `aemb` to enter the interactive cli

```bash
# creat backup named my-first-backup
backup my-first-backup
```

```
# List available backups
list
```
```
# restore a backup
restore
# a list of backups to chose from will appear
```
```
# delete a backup
delete
# a list of backups to chose from will appear

```


## Why?
I break my AEM local instances more times that I can count, sometimes beyond repair. This usually means I have to start fresh and install content packages, update packages, my project code and do any other required manual configuration for my project... if you cant tell, this is tedious and I've decided: NO MORE!

## How does it work?
This tool does an **offline** **filesystem** backup of your whole AEM instance, basically the `crx-quickstart` folder.

> Since this tool does a **filesystem** backup, your AEM instance must be **shutdown** while performing a backup/restore.

### Yeah but how exactly?
using the [`node-tar`](https://github.com/npm/node-tar) module, this CLI creats a [tar](https://en.wikipedia.org/wiki/Tar_(computing)) archive (tarball) of the `crx-quickstart` folder and saves the resulting tar into a sibling folder called `crx-quickstart.backups`.

### Interacting with the `crx-quickstart.backups` folder directly
You *can* do the following things and the CLI will still work

  -  delete the entire `crx-quickstart.backups` folder 
  -  delete one or more `.tar` backups in the `crx-quickstart.backups` folder 
  -  Add a `.tar` backup in the `crx-quickstart.backups` folder (as long as it's just a tar, not a compressed tar)*. 
  
  > *I cant guarantee that adding any tar of `crx-quickstart` to `crx-quickstart.backups` will work, however, any backup tar generated by this tool, *should* work. eg, your friend makes a backup of his instance, then sends you the tar, that should work just fine.

## caveats
1. The CLI creates a tarball of the whole `crx-quickstart` directory, that directory is usually above `2.5GB`(clean AEM instance). Thus, the backup and restore speeds depends on your computer specs.
2. To enhance backup performance, the CLI creats a tarball but does **NOT compress!** This ensures fast backups, however, it will keep the backup size the same. Make sure you delete unwanted backups.




 
